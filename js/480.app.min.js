(self.webpackChunkfls_start=self.webpackChunkfls_start||[]).push([[480],{574:()=>{},748:()=>{},246:()=>{},645:(e,t,n)=>{"use strict";n.r(t);var s=n(643),l=n(676);const c=document.querySelector(".js-gen-front"),i=document.getElementById("canvas"),o=document.getElementById("js-file"),a=document.querySelectorAll(".js-upload-image"),r=document.querySelector(".js-gen-back"),d=document.querySelector("body"),u=document.querySelector(".lines-list"),f=document.getElementById("cropper-container"),h=document.querySelector(".js-generate");let v,g,m=new l.fabric.Canvas(i);const p=[],b=652,y=667;function w(e,t){if(e)if(p[t])p[t].set({text:e}),m.renderAll();else{const n=new l.fabric.Textbox(e,{left:150,top:150+40*t,fontSize:30,fill:"black",selectable:!0});p[t]=n,m.add(n),n.bringToFront()}}function L(e){const t=new FileReader;t.readAsDataURL(e),t.onloadend=function(){const e=document.createElement("img");e.src=t.result,e.style.maxWidth="100%",f.innerHTML="",f.appendChild(e);const n=document.createElement("button");n.textContent="Обрезать",n.classList.add("crop-button"),f.appendChild(n),c.style.display="none",r.style.display="block",d.classList.add("generator-active"),v&&v.destroy(),f.classList.add("is-active"),v=new s(e,{viewMode:1,aspectRatio:1,autoCropArea:1}),n.addEventListener("click",(()=>{const e=v.getCroppedCanvas({width:b,height:y});m.clear();const t=new l.fabric.Rect({left:0,top:0,fill:"white",width:b,height:y,selectable:!1});m.add(t),l.fabric.Image.fromURL(e.toDataURL(),(e=>{e.set({left:(b-e.width)/2,top:(y-e.height)/2,selectable:!1}),m.add(e),g=e})),f.innerHTML="",f.classList.remove("is-active")}))}}m.setWidth(b),m.setHeight(y),o.addEventListener("change",(e=>{var t;t=e.target.files,[...t].forEach(L)})),a.forEach((e=>{e.addEventListener("click",(()=>{o.click()}))}));document.querySelectorAll(".js-create-blank").forEach((e=>{e.addEventListener("click",(()=>{m.clear();const e=new l.fabric.Rect({left:0,top:0,fill:"white",width:b,height:y,selectable:!1});m.add(e),c.style.display="none",r.style.display="block",d.classList.add("generator-active")}))}));document.querySelector(".js-add-line").addEventListener("click",(()=>{!function(e=""){const t=document.createElement("div");t.classList.add("step-3-text-line"),t.innerHTML=`\n    <div class="line-top">\n      <div class="line-top-left">\n        <div class="line-name">Text Line #${u.children.length+1}</div>\n        <div class="line-remove">\n          <button class="line-remove-button js-remove-line">\n            <svg style="width: 0.875rem; height: 1rem; fill: #6C757D;">\n              <use xlink:href="img/icons/icons.svg#remove"></use>\n            </svg>\n          </button>\n        </div>\n      </div>\n      <div class="line-top-right">\n        <div class="settings-config">\n          <span class="settings-text">Settings <span class="js-settings-on-off">Off</span></span>\n          <button class="settings-switch">\n            <svg style="width: 1.5rem; height: 0.9375rem; fill: #F5487F;">\n              <use xlink:href="img/icons/icons.svg#switch"></use>\n            </svg>\n          </button>\n        </div>\n        <div class="line-colors">\n          <button class="color-button color-1" style="background-color: #fff;"></button>\n          <button class="color-button color-2" style="background-color: #000;"></button>\n        </div>\n      </div>\n    </div>\n    <textarea class="step-text" placeholder="Enter top text" name="step_text">${e}</textarea>\n  `,u.appendChild(t);const n=u.children.length-1;t.querySelector(".step-text").addEventListener("input",(e=>{w(e.target.value,n)})),t.querySelector(".js-remove-line").addEventListener("click",(()=>{u.removeChild(t),m.remove(p[n]),p.splice(n,1);for(let e=n;e<p.length;e++)p[e].set({top:150+40*e}),u.children[e].querySelector(".line-name").textContent=`Text Line #${e+1}`;m.renderAll()})),w(e,n)}()})),function(){m.clear();const e=new l.fabric.Rect({left:0,top:0,fill:"white",width:b,height:y,selectable:!1});m.add(e)}(),h.addEventListener("click",(function(){const e=m.toDataURL({format:"png",quality:1}),t=document.createElement("a");t.href=e,t.download="canvas-image.png",t.click()}))}}]);