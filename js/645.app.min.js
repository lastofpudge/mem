"use strict";(self.webpackChunkfls_start=self.webpackChunkfls_start||[]).push([[645],{645:(e,t,n)=>{n.r(t);var a=n(643);const d=document.querySelector(".js-gen-front"),i=document.getElementById("canvas"),s=document.getElementById("js-file"),o=document.querySelectorAll(".js-upload-image"),r=document.querySelector(".js-gen-back"),c=document.querySelector("body"),l=document.querySelector(".step-text"),h=document.getElementById("cropper-container");let u,g,f="",m=!1,y={x:0,y:0},p={x:150,y:150};if(i){const v=i.getContext("2d");function w(){v.clearRect(0,0,i.width,i.height),v.fillStyle="white",v.fillRect(0,0,i.width,i.height),u&&v.drawImage(u,0,0,u.width,u.height),v.fillStyle="black",v.font="30px Arial",v.fillText(f,p.x,p.y)}function E(e){e.preventDefault(),e.stopPropagation()}function L(e){[...e].forEach(x)}function x(e){const t=new FileReader;t.readAsDataURL(e),t.onloadend=function(){const e=document.createElement("img");e.src=t.result,e.style.maxWidth="100%",h.innerHTML="",h.appendChild(e);const n=document.createElement("button");n.textContent="Обрезать",n.classList.add("crop-button"),h.appendChild(n),d.style.display="none",r.style.display="block",c.classList.add("generator-active"),g&&g.destroy(),h.classList.add("is-active"),g=new a(e,{viewMode:1}),n.addEventListener("click",(()=>{const e=g.getCroppedCanvas();i.width=e.width,i.height=e.height,v.clearRect(0,0,i.width,i.height),v.drawImage(e,0,0,i.width,i.height),h.innerHTML="",h.classList.remove("is-active"),u=new Image,u.src=e.toDataURL(),u.onload=function(){window.updateImage(u)}}))}}i.width=652,i.height=667,l.addEventListener("input",(e=>{f=e.target.value,w()})),window.updateImage=function(e){u=e,w()},s.addEventListener("change",(e=>{L(e.target.files)})),o.forEach((e=>{e.addEventListener("click",(()=>{s.click()}))})),d&&(["dragenter","dragover","dragleave","drop"].forEach((e=>{d.addEventListener(e,E,!1)})),["dragenter","dragover"].forEach((e=>{d.addEventListener(e,(()=>d.classList.add("highlight")),!1)})),["dragleave","drop"].forEach((e=>{d.addEventListener(e,(()=>d.classList.remove("highlight")),!1)})),d.addEventListener("drop",(e=>{const t=e.dataTransfer,n=t.files;t.types.includes("text/html")||L(n)})));document.querySelectorAll(".js-create-blank").forEach((e=>{e.addEventListener("click",(()=>{i.width=652,i.height=667,v.fillStyle="white",v.fillRect(0,0,i.width,i.height),d.style.display="none",r.style.display="block",c.classList.add("generator-active")}))})),i.addEventListener("mousedown",(e=>{const{offsetX:t,offsetY:n}=e;t>=p.x&&t<=p.x+v.measureText(f).width&&n>=p.y-20&&n<=p.y&&(m=!0,y.x=t-p.x,y.y=n-p.y)})),i.addEventListener("mousemove",(e=>{m&&(p.x=e.offsetX-y.x,p.y=e.offsetY-y.y,w())})),i.addEventListener("mouseup",(()=>{m=!1})),i.addEventListener("mouseout",(()=>{m=!1}))}}}]);